(this["webpackJsonpreact-redux-todos"]=this["webpackJsonpreact-redux-todos"]||[]).push([[0],{29:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(13),o=n.n(a),i=n(3),s=n(8),d=n(2),l=(n(29),n(0));var u=function(){return Object(l.jsx)("footer",{className:"footer",children:Object(l.jsx)("div",{className:"container",children:Object(l.jsx)("p",{className:"copyright",children:"React Redux ToDos. MIT 2021. Armand Philippot."})})})},j=n(4);var b=function(e){var t=e.children,n=e.modifiers,c=e.onClickHandler,r=e.type,a=void 0===r?"button":r,o="btn";if(n&&n.length>0)for(var i=0;i<n.length;i++)o+=" btn--".concat(n[i]);return Object(l.jsx)("button",{type:a,className:o,onClick:c,children:t})};var f=function(e){var t=e.children,n=e.legend;return Object(l.jsxs)("fieldset",{className:"form__fieldset",children:[Object(l.jsx)("legend",{className:"form__legend",children:n}),t]})};var O=function(e){var t=e.label,n=e.id,c=e.name,r=e.value,a=e.updateValue,o=e.onBlurHandler,i=e.required,s=e.type,d=void 0===s?"text":s;return Object(l.jsxs)(l.Fragment,{children:[t&&Object(l.jsx)("label",{htmlFor:n,className:"form__label",children:t}),Object(l.jsx)("input",{type:d,id:n,name:c,value:"checkbox"===d?void 0:r,checked:"checkbox"===d?r:null,required:!!i&&"required",onChange:function(e){"checkbox"===e.target.type?a(e.target.checked):a(e.target.value)},onBlur:o,className:"form__field"})]})};var m=function(e){var t=e.label,n=e.id,c=e.value,r=e.updateValue;return Object(l.jsxs)(l.Fragment,{children:[t?Object(l.jsx)("label",{htmlFor:n,className:"form__label",children:t}):"",Object(l.jsx)("textarea",{value:c,onChange:function(e){r(e.target.value)},className:"form__field form__field--textarea"})]})};n(31),n(32);var h=function(e){var t=e.username,n=e.isExpanded,c=e.setIsExpanded;return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(b,{modifiers:["user"],onClickHandler:function(){return c(!n)},children:t}),n?Object(l.jsx)("nav",{className:"nav nav--user",children:Object(l.jsxs)("ul",{className:"nav__list",children:[Object(l.jsx)("li",{className:"nav__item",children:Object(l.jsx)(s.b,{to:"/account",className:"nav__link",children:"Account"})}),Object(l.jsx)("li",{className:"nav__item",children:Object(l.jsx)(s.b,{to:"/logout",className:"nav__link",children:"Logout"})})]})}):""]})};n(35);var x=function(){var e=Object(c.useState)(!1),t=Object(j.a)(e,2),n=t[0],r=t[1],a=Object(i.c)((function(e){return e.auth.currentUser})),o=Object(c.useRef)(null),s=Object(d.h)();return Object(c.useEffect)((function(){r(!1)}),[s.pathname]),Object(l.jsx)("header",{ref:o,className:"header",onBlur:function(e){o.current.contains(e.relatedTarget)||r(!1)},children:Object(l.jsxs)("div",{className:"container",children:[Object(l.jsx)("h1",{className:"branding",children:"ToDos App"}),a?Object(l.jsx)(h,{username:a.username,isExpanded:n,setIsExpanded:r}):""]})})};n(36);var p=function(e){var t=e.children;return Object(l.jsx)("main",{className:"main container",children:t})};n(37);var v=function(){var e=Object(i.c)((function(e){return e.auth.currentUser}));return Object(l.jsxs)("div",{children:[Object(l.jsx)(s.b,{to:"/",children:"Back to your todo list"}),Object(l.jsx)("h2",{children:"Account"}),Object(l.jsxs)("dl",{className:"account-details",children:[Object(l.jsx)("dt",{className:"account-details__headings",children:"Username"}),Object(l.jsx)("dd",{className:"account-details__data",children:e.username}),Object(l.jsx)("dt",{className:"account-details__headings",children:"Email"}),Object(l.jsx)("dd",{className:"account-details__data",children:e.email}),Object(l.jsx)("dt",{className:"account-details__headings",children:"Creation date"}),Object(l.jsx)("dd",{className:"account-details__data",children:new Date(e.createdAt).toLocaleDateString()})]})]})},g=n(5),_=n(9),N={currentUser:null,isAuthenticated:!1},S=Object(_.b)({name:"auth",initialState:N,reducers:{login:function(e,t){return Object(g.a)(Object(g.a)({},e),{},{currentUser:t.payload,isAuthenticated:!0})},logout:function(){return N}}}),y=S.actions,k=y.login,w=y.logout,C=S.reducer;var I=function(){var e,t=Object(c.useState)(""),n=Object(j.a)(t,2),r=n[0],a=n[1],o=Object(c.useState)(""),s=Object(j.a)(o,2),u=s[0],m=s[1],h=Object(c.useState)(""),x=Object(j.a)(h,2),p=x[0],v=x[1],g=Object(i.c)((function(e){return e.users})),_=Object(i.b)(),N=Object(d.g)(),S=function(e){return g.find((function(t){return t.email===e}))};return Object(l.jsxs)("form",{action:"#",method:"post",className:"form form--login",onSubmit:function(e){if(e.preventDefault(),S(r)){var t=S(r);!function(e,t){return e.password===t}(t,u)?v("The password does not match."):(v(""),_(k(t)),N.push("/"))}else v("This email address does not exist.")},children:[(e=p,e?Object(l.jsx)("p",{children:e}):""),Object(l.jsxs)(f,{legend:"Sign In",children:[Object(l.jsx)(O,{label:"Email",id:"login-email",name:"login-email",value:r,updateValue:a,type:"email",required:!0}),Object(l.jsx)(O,{label:"Password",id:"login-password",name:"login-password",value:u,updateValue:m,type:"password",required:!0}),Object(l.jsx)(b,{type:"submit",modifiers:["submit"],children:"Log in"})]})]})};var A=function(){var e=Object(i.b)(),t=Object(d.g)();return Object(c.useEffect)((function(){e(w()),t.push("/")})),Object(l.jsx)(l.Fragment,{children:"Logging out..."})},D=n(19),T=Object(_.b)({name:"todos",initialState:[{id:Object(_.c)(),createdAt:(new Date).toISOString(),title:"Build a todo app",body:"",userId:"demo",done:!1}],reducers:{addTodo:{reducer:function(e,t){e.push(t.payload)},prepare:function(e){var t=e.userId,n=e.title,c=e.body,r=void 0===c?"":c;return{payload:{id:Object(_.c)(),createdAt:(new Date).toISOString(),userId:t,title:n,body:r}}}},deleteTodo:function(e,t){return e.filter((function(e){return e.id!==t.payload}))},updateTodo:function(e,t){return e.map((function(e){return e.id!==t.payload.id?e:Object(g.a)(Object(g.a)({},e),t.payload)}))},toggleTodo:function(e,t){var n=t.payload,c=e.findIndex((function(e){return e.id===n})),r=e[c];return[].concat(Object(D.a)(e.slice(0,c)),[Object(g.a)(Object(g.a)({},r),{},{done:!r.done})],Object(D.a)(e.slice(c+1)))},deleteAllTodos:function(){return[]}}}),U=T.actions,E=U.addTodo,F=U.deleteTodo,V=U.updateTodo,H=U.toggleTodo,B=U.deleteAllTodos,L=T.reducer;var q=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(c.useState)(e),n=Object(j.a)(t,2),r=n[0],a=n[1],o=Object(c.useCallback)((function(){return a((function(e){return!e}))}),[]);return[r,o]};n(38);var R=function(){var e=q(),t=Object(j.a)(e,2),n=t[0],r=t[1],a=q(),o=Object(j.a)(a,2),u=o[0],b=o[1],f=Object(c.useRef)(null),O=Object(c.useRef)(null),m=Object(d.h)().state.todoId,h=Object(i.c)((function(e){return e.todos})).find((function(e){return e.id===m})),x=h.title,p=h.body,v=Object(i.b)();Object(c.useEffect)((function(){f.current&&f.current.focus(),O.current&&O.current.focus()}));var _=function(e){console.log(e)};return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(s.b,{to:"/",children:"Back to your todo list"}),Object(l.jsxs)("div",{className:"todo",children:[n?Object(l.jsx)("form",{action:"#",method:"post",className:"todo-form todo__title",onSubmit:_,children:Object(l.jsx)("input",{ref:f,className:"todo-form__field",type:"text",name:"title",value:x,onChange:function(e){return v(V(Object(g.a)(Object(g.a)({},h),{},{title:e.target.value})))},onBlur:r})}):Object(l.jsx)("div",{className:"todo__title",onClick:r,children:x}),u?Object(l.jsx)("form",{action:"#",method:"post",className:"todo-form todo__body",onSubmit:_,children:Object(l.jsx)("textarea",{ref:O,className:"todo-form__field todo-form__field--textarea",name:"body",value:p,onChange:function(e){return v(V(Object(g.a)(Object(g.a)({},h),{},{body:e.target.value})))},onBlur:b})}):Object(l.jsx)("div",{className:"todo__body",onClick:b,children:p})]})]})};var J=function(e){var t=e.userId,n=e.closeForm,r=Object(c.useState)(""),a=Object(j.a)(r,2),o=a[0],s=a[1],d=Object(c.useState)(""),u=Object(j.a)(d,2),h=u[0],x=u[1],p=Object(i.b)();return Object(l.jsx)("form",{onSubmit:function(e){e.preventDefault(),n((function(e){return!e}))},className:"form form--todo",children:Object(l.jsxs)(f,{legend:"Add a new todo",children:[Object(l.jsx)(O,{label:"Title",value:o,updateValue:s}),Object(l.jsx)(m,{label:"Details",value:h,updateValue:x}),Object(l.jsx)(b,{type:"submit",modifiers:["submit"],onClickHandler:function(){p(E({userId:t,title:o,body:h}))},children:"Save"})]})})};var M=function(e){var t=e.todo,n=t.id,r=t.createdAt,a=t.title,o=t.done,d=Object(c.useState)(!1),u=Object(j.a)(d,2),f=u[0],m=u[1],h=Object(i.b)();Object(c.useEffect)((function(){o&&m(!0)}),[o]);var x=a.toString().normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w-]+/g,"-").replace(/--+/g,"-").replace(/^-|-$/g,""),p="todos-list__item ".concat(f?"todos-list__item--done":"");return Object(l.jsxs)("li",{className:p,children:[Object(l.jsx)("span",{className:"todo__date",children:new Date(r).toLocaleDateString()}),Object(l.jsx)("span",{className:"todo__title",children:Object(l.jsx)(s.b,{to:{pathname:"/todo/".concat(x),state:{todoId:t.id}},children:a})}),Object(l.jsx)(O,{type:"checkbox",label:"Done?",id:n,value:f,updateValue:function(e){m(e),h(H(n))}}),Object(l.jsx)(b,{modifiers:["action","delete"],onClickHandler:function(){return h(F(n))},children:"Delete"})]})},P=(n(39),function(e){try{var t=localStorage.getItem(e);if(!t)return;return JSON.parse(t)}catch(n){return void console.log(n)}}),z=function(e,t){try{var n=JSON.stringify(t);localStorage.setItem(e,n)}catch(c){console.log(c)}},W=function(e){localStorage.removeItem(e)};var $=function(e){var t=e.currentView,n=e.setCurrentView,c=["filters"],r=["filters"],a=["filters"];switch(t){case"all":c.push("current");break;case"ongoing":r.push("current");break;case"completed":a.push("current")}return Object(l.jsxs)("div",{className:"todos-filters",children:["Show:",Object(l.jsx)(b,{modifiers:c,onClickHandler:function(){return n("all")},children:"All"}),Object(l.jsx)(b,{modifiers:r,onClickHandler:function(){return n("ongoing")},children:"Ongoing"}),Object(l.jsx)(b,{modifiers:a,onClickHandler:function(){return n("completed")},children:"Completed"})]})};var G=function(){var e=Object(c.useState)([]),t=Object(j.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)("all"),o=Object(j.a)(a,2),s=o[0],d=o[1],u=Object(i.b)(),f=Object(c.useState)(!1),O=Object(j.a)(f,2),m=O[0],h=O[1],x=Object(i.c)((function(e){return e.auth.currentUser})),p=Object(i.c)((function(e){return e.todos}));Object(c.useEffect)((function(){var e=p.filter((function(e){return e.userId===x.id}));r((function(){var t;switch(s){case"completed":t=e.filter((function(e){return e.done}));break;case"ongoing":t=e.filter((function(e){return!e.done}));break;default:t=e}return t}))}),[s,p,x.id]),Object(c.useEffect)((function(){z("todoList",p)}));var v=n.map((function(e){return Object(l.jsx)(M,{todo:e},e.id)}));return Object(l.jsxs)("div",{children:[Object(l.jsxs)("h2",{children:["Welcome back ",x.username,"!"]}),Object(l.jsxs)("div",{className:"todos-actions",children:[Object(l.jsx)(b,{modifiers:["action"],onClickHandler:function(){return h(!m)},children:"New todo"}),Object(l.jsx)(b,{modifiers:["action","delete"],onClickHandler:function(){return u(B())},children:"Delete all"})]}),m?Object(l.jsx)(J,{userId:x.id,closeForm:h}):"",Object(l.jsx)($,{currentView:s,setCurrentView:d}),v.length>0?Object(l.jsx)("ul",{className:"todos-list",children:v}):""]})};n(40),n(41);var K=function(){var e=Object(i.c)((function(e){return e.auth.isAuthenticated}));return Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(x,{}),Object(l.jsx)(p,{children:Object(l.jsxs)(d.d,{children:[Object(l.jsx)(d.b,{path:"/account",component:v,children:e?Object(l.jsx)(v,{}):Object(l.jsx)(d.a,{to:"/login"})}),Object(l.jsx)(d.b,{path:"/login",component:I}),Object(l.jsx)(d.b,{path:"/logout",component:A}),Object(l.jsx)(d.b,{path:"/todo/:string",component:R,children:e?Object(l.jsx)(R,{}):Object(l.jsx)(d.a,{to:"/login"})}),Object(l.jsx)(d.b,{exact:!0,strict:!0,path:"/",children:e?Object(l.jsx)(G,{}):Object(l.jsx)(d.a,{to:"/login"})})]})}),Object(l.jsx)(u,{})]})},Q=Object(_.b)({name:"users",initialState:[{id:"demo",createdAt:(new Date).toISOString(),username:"Demo",email:"demo@email.com",password:"demo"}],reducers:{addUser:{reducer:function(e,t){e.push(t.payload)},prepare:function(e,t,n){return{payload:{id:Object(_.c)(),username:e,email:t,password:n,createdAt:(new Date).toISOString()}}}},deleteUser:function(e,t){e.filter((function(e){return e.id!==t.payload}))},updateUser:function(e,t){e.map((function(e){return e.id!==t.payload.id?e:Object(g.a)(Object(g.a)({},e),t.payload)}))}}}),X=Q.actions,Y=(X.addUser,X.deleteUser,X.updateUser,{auth:C,todos:L,users:Q.reducer}),Z=function(e){return function(t){return function(n){var c=n.type,r=t(n);switch(c){case"auth/login":var a=e.getState().auth;z("todoUser",a.currentUser);break;case"auth/logout":W("todoUser");break;case"todos/updateTodo":var o=e.getState().todos;z("todoList",o)}return r}}},ee=P("todoUser"),te=ee?{isAuthenticated:!0,currentUser:ee}:void 0,ne=P("todoList"),ce={auth:te,todos:ne||void 0},re=Object(_.a)({reducer:Y,middleware:function(e){return e().concat(Z)},preloadedState:ce});o.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(i.a,{store:re,children:Object(l.jsx)(s.a,{children:Object(l.jsx)(K,{})})})}),document.getElementById("app"))}},[[42,1,2]]]);
//# sourceMappingURL=main.7b54eccb.chunk.js.map